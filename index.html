<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sashiko Pattern Designer</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div id="app">
    <h1>Sashiko Pattern Designer</h1>
    <div id="controls">
      <div id="drawing-tools">
        <button id="selectMode" class="tool-btn" title="Select Mode (V) - Click to select and edit stitches"><img
            src="icons/mouse-pointer-2.svg" alt="Select" class="icon"></button>
        <button id="toolLine" class="tool-btn active" title="Line Tool - Draw straight lines"><img
            src="icons/pencil-line.svg" alt="Draw Line" class="icon"></button>
        <button id="toolCircle" class="tool-btn" title="Circle Tool - Draw circles"><img src="icons/circle.svg"
            alt="Circle" class="icon"></button>
        <button id="toolBox" class="tool-btn" title="Box Tool - Draw rectangles"><img src="icons/square.svg" alt="Box"
            class="icon"></button>
        <button id="toolCurve" class="tool-btn" title="Curve Tool - Draw curved lines with control points">
          <img src="icons/spline.svg" alt="Curve" class="icon">
        </button>
        <button id="toolPen" class="tool-btn" title="Pen Tool - Draw freehand paths with smoothing">
          <img src="icons/pen-tool.svg" alt="Pen Tool" class="icon">
        </button>
      </div>
      <div id="edit-tools">
        <button id="undo" class="tool-btn" title="Undo Last Action (Ctrl+Z)"><img src="icons/undo.svg" alt="Undo"
            class="icon"></button>

        <button id="toggleGrid" title="Toggle Grid Visibility"><img src="icons/grid-3x3.svg" alt="Toggle Grid"
            class="icon"></button>
        <button id="clear" title="Clear Canvas - Remove all stitches"><img src="icons/brush-cleaning.svg"
            alt="Clear Canvas" class="icon"></button>
        <button id="savePattern" title="Save Pattern - Download as image">
          <img src="icons/image-down.svg" alt="Save" class="icon">
        </button>
        <button id="helpBtn" class="tool-btn" title="Show Help - Keyboard shortcuts and tools">
          <img src="icons/circle-question-mark.svg" alt="Help" class="icon">
        </button>
      </div>
      <label>Grid Size: <input type="range" id="gridSize" min="10" max="50" value="20"></label>
      <label>Stitch Length: <input type="range" id="stitchLength" min="3" max="30" value="10"></label>
      <label><input type="checkbox" id="stitchLock"> Lock to Grid</label>
      <label><input type="checkbox" id="freehand"> Freehand Mode</label>
      <label>Stitch Color: <input type="color" id="stitchColor" value="#ffffff"></label>
    </div>
    <div id="canvas-container"></div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Sashiko Pattern Designer - Help</h2>

      <div class="help-section">
        <h3>Drawing Tools</h3>
        <ul>
          <li><strong>Line Tool</strong> - Draw straight lines between two points</li>
          <li><strong>Circle Tool</strong> - Draw circles from center to radius</li>
          <li><strong>Box Tool</strong> - Draw rectangles by defining corners</li>
          <li><strong>Curve Tool</strong> - Draw smooth curves with control points</li>
          <li><strong>Pen Tool</strong> - Draw freehand paths with automatic smoothing</li>
        </ul>
      </div>

      <div class="help-section">
        <h3>Edit Mode</h3>
        <ul>
          <li><strong>Select Mode (V)</strong> - Click any stitch to select it</li>
          <li><strong>Drag Control Points</strong> - Move yellow circles to adjust shape</li>
          <li><strong>Color Editing</strong> - Change stitch color picker to update selected stitch</li>
          <li><strong>Delete (Del)</strong> - Remove selected stitch</li>
          <li><strong>Deselect (Esc)</strong> - Clear selection</li>
        </ul>
      </div>

      <div class="help-section">
        <h3>Path Point Editing</h3>
        <p>When a path is selected, click on individual points to edit:</p>
        <ul>
          <li><strong>Delete Key</strong> - Delete selected point (minimum 3 points required)</li>
          <li><strong>M Key</strong> - Merge selected point with next point</li>
          <li><strong>Drag Points</strong> - Move individual path points</li>
        </ul>
      </div>

      <div class="help-section">
        <h3>Keyboard Shortcuts</h3>
        <ul>
          <li><strong>V</strong> - Switch to Select Mode</li>
          <li><strong>Ctrl+Z / Cmd+Z</strong> - Undo last action</li>
          <li><strong>Delete / Backspace</strong> - Delete selected stitch</li>
          <li><strong>Escape</strong> - Deselect current selection</li>
          <li><strong>Selected Point + Delete</strong> - Delete selected path point</li>
          <li><strong>Selected Point + M</strong> - Merge selected path point with next</li>
        </ul>
      </div>

      <div class="help-section">
        <h3>Settings</h3>
        <ul>
          <li><strong>Grid Size</strong> - Adjust spacing between grid lines (10-50px)</li>
          <li><strong>Stitch Length</strong> - Control dash length in stitches (3-30px)</li>
          <li><strong>Lock to Grid</strong> - Snap points to grid intersections</li>
          <li><strong>Freehand Mode</strong> - Disable grid snapping for organic shapes</li>
          <li><strong>Toggle Grid</strong> - Show/hide grid overlay</li>
        </ul>
      </div>

      <div class="help-section">
        <h3>Actions</h3>
        <ul>
          <li><strong>Undo</strong> - Revert last action (up to 50 actions)</li>
          <li><strong>Clear Canvas</strong> - Remove all stitches from canvas</li>
          <li><strong>Save Pattern</strong> - Download current pattern as PNG image</li>
        </ul>
      </div>
    </div>
  </div>

  <script src="sketch.js"></script>
</body>

</html>